<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>FANTASYAS</title>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;600;700;800&display=swap" rel="stylesheet"/>
<style>
:root {
  --bg-primary: #000;
  --text-primary: #fff;
  --bg-secondary: rgba(255,255,255,0.05);
  --border: rgba(255,255,255,0.1);
  --accent-gradient: linear-gradient(90deg, #fff, #aaa);
  --text-secondary: #aaa;
  --blur: blur(10px);
  --transition: all 0.3s ease;
}

body.light {
  --bg-primary: #f8f9fa;
  --text-primary: #111;
  --bg-secondary: rgba(0,0,0,0.03);
  --border: rgba(0,0,0,0.08);
  --accent-gradient: linear-gradient(90deg, #000, #444);
  --text-secondary: #555;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Manrope', sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  min-height: 100vh;
  overflow-x: hidden;
  transition: background 0.4s, color 0.4s;
}
body.large-font { font-size: 1.12rem; }

/* –¢–æ–ø-–±–∞—Ä */
.top-bar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 80px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 24px;
  background: rgba(0,0,0,0.4);
  backdrop-filter: var(--blur);
  border-bottom: 1px solid var(--border);
  z-index: 1000;
  transition: var(--transition);
}

body.light .top-bar { background: rgba(255,255,255,0.7); }

.site-name {
  font-size: 1.8rem;
  font-weight: 800;
  background: var(--accent-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* –ë—É—Ä–≥–µ—Ä */
.burger {
  position: relative;
  width: 32px;
  height: 24px;
  cursor: pointer;
  transition: var(--transition);
}

.burger span {
  position: absolute;
  width: 100%;
  height: 3px;
  background: var(--text-primary);
  border-radius: 2px;
  transition: all 0.35s cubic-bezier(0.65, -0.15, 0.35, 1.35);
}

.burger span:nth-child(1) { top: 0; }
.burger span:nth-child(2) { top: 10px; }
.burger span:nth-child(3) { top: 20px; }

.burger.active span:nth-child(1) { transform: rotate(45deg) translate(8px, 8px); }
.burger.active span:nth-child(2) { opacity: 0; transform: translateX(-20px); }
.burger.active span:nth-child(3) { transform: rotate(-45deg) translate(7px, -7px); }

/* –°–∞–π–¥–±–∞—Ä (–ª—ñ–≤–µ –º–µ–Ω—é) */
.sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: 280px;
  height: 100%;
  background: rgba(0,0,0,0.92);
  backdrop-filter: blur(16px) saturate(180%);
  border-right: 1px solid var(--border);
  transform: translateX(-100%);
  transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
  padding: 120px 32px 32px;
  z-index: 950;
  overflow-y: auto;
}

body.light .sidebar { background: rgba(255,255,255,0.92); }

.sidebar.active { transform: translateX(0); }

.sidebar a {
  display: flex;
  align-items: center;
  gap: 12px;
  color: var(--text-secondary);
  font-size: 1.28rem;
  font-weight: 600;
  padding: 14px 16px;
  border-radius: 12px;
  margin: 8px 0;
  transition: var(--transition);
  text-decoration: none;
  cursor: pointer;
}

.sidebar a:hover {
  background: var(--bg-secondary);
  color: var(--text-primary);
  padding-left: 24px;
  transform: translateX(6px);
}

/* –ë–µ–∫–¥—Ä–æ–ø –¥–ª—è –º–µ–Ω—é */
.backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(4px);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease;
  z-index: 800;
}

.backdrop.active {
  opacity: 1;
  pointer-events: all;
}

/* –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç */
.main-content { margin-top: 100px; padding: 20px 25px; transition: var(--transition); }

.section { display: none; padding: 0 8px; }
.section.active { display: block; animation: fadeIn 0.5s ease; }

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* –§–æ—Ä–º–∏ —Ç–∞ –±–æ–∫—Å–∏ */
.login-box, .new-post, .settings, .profile-edit-form {
  margin-bottom: 20px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px;
  transition: var(--transition);
  animation: scaleIn 0.4s ease;
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

input, textarea {
  padding: 12px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--bg-secondary);
  color: var(--text-primary);
  outline: none;
  font-family: 'Manrope', sans-serif;
  resize: vertical;
  transition: var(--transition);
}

input::placeholder, textarea::placeholder { color: var(--text-secondary); }

button {
  width: fit-content;
  padding: 10px 18px;
  border: none;
  border-radius: 12px;
  background: var(--text-primary);
  color: var(--bg-primary);
  font-weight: 700;
  cursor: pointer;
  transition: opacity 0.2s, transform 0.2s;
}

button:hover { opacity: 0.9; transform: scale(1.05); }

.danger-btn { background: #c53030 !important; color: #fff !important; }
.danger-btn:hover { background: #a71d2a !important; }

/* –§—ñ–¥ –ø–æ—Å—Ç—ñ–≤ */
.feed { display: flex; flex-direction: column; gap: 20px; }

.post {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 18px;
  transition: var(--transition);
  animation: slideUp 0.5s ease;
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}

.post:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.2); }

.post-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
.avatar { width: 48px; height: 48px; border-radius: 50%; background-size: cover; background-position: center; transition: var(--transition); }
.username { font-weight: 700; font-size: 1.05rem; }
.post-content { font-size: 0.95rem; line-height: 1.5; margin-bottom: 12px; }
.post-meta { color: var(--text-secondary); font-size: 0.8rem; margin-top: 4px; }
.post-footer { display: flex; gap: 20px; margin-top: 12px; }
.post-footer button { background: none; border: none; color: var(--text-secondary); cursor: pointer; display: flex; align-items: center; gap: 6px; transition: var(--transition); }
.post-footer button:hover { color: var(--text-primary); transform: scale(1.1); }

/* –†–µ—à—Ç–∞ —Å—Ç–∏–ª—ñ–≤ –∑–∞–ª–∏—à–∏–≤ –±–µ–∑ –∑–º—ñ–Ω */
</style>
</head>
<body>

<div class="top-bar">
  <div class="burger" id="burger"><span></span><span></span><span></span></div>
  <div class="site-name">FANTASYAS</div>
</div>

<nav class="sidebar" id="sidebar">
  <a data-section="home" id="homeLink">–ì–æ–ª–æ–≤–Ω–∞</a>
  <a data-section="profile">–ü—Ä–æ—Ñ—ñ–ª—å</a>
  <a data-section="settings">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</a>
  <a href="#">–ü—Ä–æ –Ω–∞—Å</a>
  <a href="#">–ü–æ—Å–ª—É–≥–∏</a>
  <a href="#">–ü–æ—Ä—Ç—Ñ–æ–ª—ñ–æ</a>
  <a href="#">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a>
</nav>

<div class="backdrop" id="backdrop"></div>

<main class="main-content">
  <div id="home" class="section active">
    <div class="login-box" id="loginBox">
      <input type="text" id="usernameInput" placeholder="–í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—î —ñ–º'—è">
      <button id="saveUsername">–ü–æ—á–∞—Ç–∏</button>
    </div>
    <div class="new-post" id="newPostBox" style="display:none;">
      <textarea id="postText" placeholder="–©–æ —É —Ç–µ–±–µ –Ω–∞ –¥—É–º—Ü—ñ?..." rows="4"></textarea>
      <button id="addPost">–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
    </div>
    <div class="feed" id="feed"></div>
  </div>
  <!-- –ü—Ä–æ—Ñ—ñ–ª—å —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω -->
</main>

<script>
const KEY = { USERNAME:'fantasyasUsername', USER:'fantasyasUserData', POSTS:'fantasyas_posts_v4' };
let username = localStorage.getItem(KEY.USERNAME);
let userData = JSON.parse(localStorage.getItem(KEY.USER)) || { avatar:'', bio:'', registered:new Date().toISOString().split('T')[0], favorites:[] };
let posts = JSON.parse(localStorage.getItem(KEY.POSTS)) || [];

const burger = document.getElementById('burger');
const sidebar = document.getElementById('sidebar');
const backdrop = document.getElementById('backdrop');
const sections = document.querySelectorAll('.section');
const loginBox = document.getElementById('loginBox');
const newPostBox = document.getElementById('newPostBox');
const feed = document.getElementById('feed');

// –ë—É—Ä–≥–µ—Ä —Ç–∞ –º–µ–Ω—é
burger.addEventListener('click', ()=>{burger.classList.toggle('active'); sidebar.classList.toggle('active'); backdrop.classList.toggle('active');});
backdrop.addEventListener('click', ()=>{burger.classList.remove('active'); sidebar.classList.remove('active'); backdrop.classList.remove('active');});

// –í—ñ–¥–∫—Ä–∏—Ç—Ç—è —Å–µ–∫—Ü—ñ–π
function showSection(id){
  sections.forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  sidebar.classList.remove('active'); burger.classList.remove('active'); backdrop.classList.remove('active');
  if(id==='home') renderPosts();
}
document.querySelectorAll('[data-section]').forEach(el=>{el.addEventListener('click',()=>showSection(el.dataset.section));});

// –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
if(username){loginBox.style.display='none'; newPostBox.style.display='flex'; renderPosts();}
document.getElementById('saveUsername').addEventListener('click',()=>{
  const val=document.getElementById('usernameInput').value.trim();
  if(!val) return alert('–í–≤–µ–¥–∏ —ñ–º‚Äô—è');
  username=val; localStorage.setItem(KEY.USERNAME,username); localStorage.setItem(KEY.USER,JSON.stringify(userData));
  loginBox.style.display='none'; newPostBox.style.display='flex'; renderPosts();
});

// –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ—Å—Ç–∞
document.getElementById('addPost').addEventListener('click',()=>{
  const text=document.getElementById('postText').value.trim();
  if(!text || !username) return;
  posts.unshift({id:Date.now(),username,text,likes:0,likedBy:[],comments:[],reactions:{"‚ù§Ô∏è":0,"üî•":0,"üòÇ":0,"üòÆ":0},created:new Date().toISOString()});
  localStorage.setItem(KEY.POSTS,JSON.stringify(posts));
  document.getElementById('postText').value=''; renderPosts();
});

// –†–µ–Ω–¥–µ—Ä –ø–æ—Å—Ç—ñ–≤
function renderPosts(){
  feed.innerHTML='';
  posts.forEach(post=>{
    const postEl=document.createElement('div'); postEl.className='post';
    postEl.innerHTML=`<div class="post-header"><div class="avatar" style="background-image:url('${post.username===username?userData.avatar:''}')"></div><div class="username">${post.username}</div></div><div class="post-content">${post.text.replace(/\n/g,'<br>')}</div>`;
    feed.appendChild(postEl);
  });
}
</script>
</body>
</html><script>
const KEY = {
  USERNAME: 'fantasyasUsername',
  USER: 'fantasyasUserData',
  POSTS: 'fantasyas_posts_v4'
};

let username = localStorage.getItem(KEY.USERNAME);
let userData = JSON.parse(localStorage.getItem(KEY.USER)) || {
  avatar: '',
  bio: '',
  registered: new Date().toISOString().split('T')[0],
  favorites: []
};
let posts = JSON.parse(localStorage.getItem(KEY.POSTS)) || [];

const burger = document.getElementById('burger');
const sidebar = document.getElementById('sidebar');
const backdrop = document.getElementById('backdrop');
const sections = document.querySelectorAll('.section');
const loginBox = document.getElementById('loginBox');
const newPostBox = document.getElementById('newPostBox');
const feed = document.getElementById('feed');
const postText = document.getElementById('postText');
const modal = document.getElementById('editProfileModal');

// –ë—É—Ä–≥–µ—Ä —Ç–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è
burger.addEventListener('click', () => {
  burger.classList.toggle('active');
  sidebar.classList.toggle('active');
  backdrop.classList.toggle('active');
});

backdrop.addEventListener('click', () => {
  burger.classList.remove('active');
  sidebar.classList.remove('active');
  backdrop.classList.remove('active');
});

function showSection(id) {
  sections.forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  sidebar.classList.remove('active');
  burger.classList.remove('active');
  backdrop.classList.remove('active');
  if (id === 'profile') updateProfile();
}

document.querySelectorAll('[data-section]').forEach(el => {
  el.addEventListener('click', () => showSection(el.dataset.section));
});

// –¢–µ–º–∞ —Ç–∞ —à—Ä–∏—Ñ—Ç
function applyPreferences() {
  const theme = localStorage.getItem('fantasyasTheme') || 'dark';
  const font = localStorage.getItem('fantasyasFontSize') || 'normal';
  document.body.classList.toggle('light', theme === 'light');
  document.body.classList.toggle('large-font', font === 'large');
  document.getElementById('themeSelect').value = theme;
  document.getElementById('fontSizeSelect').value = font;
}

applyPreferences();

// –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
if (username) {
  loginBox.style.display = 'none';
  newPostBox.style.display = 'flex';
} else {
  newPostBox.style.display = 'none';
}

document.getElementById('saveUsername').addEventListener('click', () => {
  const val = document.getElementById('usernameInput').value.trim();
  if (!val) return alert('–í–≤–µ–¥–∏ —ñ–º‚Äô—è');
  username = val;
  localStorage.setItem(KEY.USERNAME, username);
  if (!userData.registered) userData.registered = new Date().toISOString().split('T')[0];
  localStorage.setItem(KEY.USER, JSON.stringify(userData));
  loginBox.style.display = 'none';
  newPostBox.style.display = 'flex';
  renderPosts();
});

// –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ—Å—Ç–∞
document.getElementById('addPost').addEventListener('click', () => {
  const text = postText.value.trim();
  if (!text || !username) return;
  posts.unshift({
    id: Date.now(),
    username,
    text,
    likes: 0,
    likedBy: [],
    comments: [],
    reactions: { "‚ù§Ô∏è":0, "üî•":0, "üòÇ":0, "üòÆ":0 },
    created: new Date().toISOString()
  });
  savePosts();
  postText.value = '';
  renderPosts();
});

// –û–±—Ä–æ–±–∫–∞ –∞–≤–∞—Ç–∞—Ä–∫–∏
function handleAvatarUpload(inputEl, isModal = false) {
  inputEl.addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;
    if (file.size > 2 * 1024 * 1024) {
      alert('–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–µ (–º–∞–∫—Å–∏–º—É–º ~2 –ú–ë)');
      e.target.value = '';
      return;
    }
    const reader = new FileReader();
    reader.onload = ev => {
      userData.avatar = ev.target.result;
      localStorage.setItem(KEY.USER, JSON.stringify(userData));
      updateProfile();
      renderPosts();
      if (isModal) modal.classList.remove('active');
      alert('–ê–≤–∞—Ç–∞—Ä –æ–Ω–æ–≤–ª–µ–Ω–æ!');
      e.target.value = '';
    };
    reader.readAsDataURL(file);
  });
}

handleAvatarUpload(document.getElementById('avatarFileInput'));
handleAvatarUpload(document.getElementById('editAvatarFile'), true);

// –†–µ–Ω–¥–µ—Ä –ø–æ—Å—Ç—ñ–≤
function renderPosts(container = feed, onlyUser = false) {
  container.innerHTML = '';
  posts.filter(p => !onlyUser || p.username === username).forEach(post => {
    const isLiked = post.likedBy?.includes(username);
    const isFavorite = userData.favorites?.includes(post.id);

    const postEl = document.createElement('div');
    postEl.className = 'post';
    postEl.style.position = 'relative';
    postEl.innerHTML = `
      <div class="post-header">
        <div class="avatar" style="background-image:url('${getAvatar(post.username)}')"></div>
        <div class="username">${post.username}</div>
      </div>
      <div class="post-content" id="content-${post.id}">${post.text.replace(/\n/g, '<br>')}</div>
      <div class="post-meta">${new Date(post.created).toLocaleString('uk-UA', {dateStyle:'short', timeStyle:'short'})}</div>
      <div class="post-footer">
        <button class="like-btn ${isLiked ? 'liked' : ''}">‚ù§Ô∏è ${post.likes || 0}</button>
        <button class="comment-btn">üí¨ ${post.comments?.length || 0}</button>
        <button class="favorite-btn ${isFavorite ? 'favorited' : ''}">‚≠ê</button>
        ${post.username === username ? '<button class="edit-btn">‚úèÔ∏è</button>' : ''}
        <button class="emoji-menu-btn">üòÉ</button>
      </div>
      <div class="emoji-picker" style="display:none;">
        <span class="emoji">‚ù§Ô∏è</span>
        <span class="emoji">üî•</span>
        <span class="emoji">üòÇ</span>
        <span class="emoji">üòÆ</span>
        <span class="emoji">ü•≥</span>
        <span class="emoji">üò¢</span>
      </div>
      <div class="reactions-container">
        ${Object.keys(post.reactions).map(e => `<span class="emoji-btn">${e} ${post.reactions[e]}</span>`).join('')}
      </div>
      <div class="comments-section" id="comments-${post.id}"></div>
      <div class="comment-input">
        <input type="text" placeholder="–ö–æ–º–µ–Ω—Ç–∞—Ä..." class="comment-inp"/>
        <button class="add-comment-btn">‚Üí</button>
      </div>
    `;

    // –õ–∞–π–∫
    postEl.querySelector('.like-btn').addEventListener('click', () => {
      if (!username) return alert('–£–≤—ñ–π–¥–∏');
      if (!post.likedBy) post.likedBy = [];
      const idx = post.likedBy.indexOf(username);
      if (idx === -1) {
        post.likedBy.push(username);
        post.likes = (post.likes || 0) + 1;
      } else {
        post.likedBy.splice(idx, 1);
        post.likes--;
      }
      savePosts();
      renderPosts(container, onlyUser);
      if (container !== feed) updateProfile();
    });

    // –§–∞–≤–æ—Ä–∏—Ç
    postEl.querySelector('.favorite-btn').addEventListener('click', () => {
      if (!username) return alert('–£–≤—ñ–π–¥–∏');
      if (!userData.favorites) userData.favorites = [];
      const idx = userData.favorites.indexOf(post.id);
      if (idx === -1) userData.favorites.push(post.id);
      else userData.favorites.splice(idx, 1);
      localStorage.setItem(KEY.USER, JSON.stringify(userData));
      renderPosts(container, onlyUser);
      if (container !== feed) updateProfile();
    });

    // –ú–µ–Ω—é –µ–º–æ–¥–∑—ñ
    const emojiBtn = postEl.querySelector('.emoji-menu-btn');
    const picker = postEl.querySelector('.emoji-picker');
    emojiBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      picker.style.display = picker.style.display === 'flex' ? 'none' : 'flex';
    });
    picker.querySelectorAll('.emoji').forEach(em => {
      em.addEventListener('click', () => {
        const emoji = em.textContent;
        if (!post.reactions[emoji]) post.reactions[emoji] = 0;
        post.reactions[emoji]++;
        savePosts();
        renderPosts(container, onlyUser);
      });
    });
    document.addEventListener('click', () => picker.style.display = 'none');

    // –†–µ–∞–∫—Ü—ñ—ó –µ–º–æ–¥–∑—ñ
    postEl.querySelectorAll('.emoji-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const emoji = btn.textContent.split(' ')[0];
        post.reactions[emoji]++;
        savePosts();
        renderPosts(container, onlyUser);
      });
    });

    // –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ
    const inp = postEl.querySelector('.comment-inp');
    const btn = postEl.querySelector('.add-comment-btn');
    btn.addEventListener('click', () => {
      const text = inp.value.trim();
      if (!text || !username) return;
      if (!post.comments) post.comments = [];
      post.comments.push({user: username, text, time: Date.now()});
      inp.value = '';
      savePosts();
      renderComments(post.id, postEl.querySelector(`#comments-${post.id}`));
      renderPosts(container, onlyUser);
    });

    // –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø–æ—Å—Ç–∞
    if (post.username === username) {
      postEl.querySelector('.edit-btn').addEventListener('click', () => {
        const contentDiv = document.getElementById(`content-${post.id}`);
        const textarea = document.createElement('textarea');
        textarea.value = post.text;
        textarea.style.width = '100%';
        textarea.style.marginTop = '10px';
        const saveBtn = document.createElement('button');
        saveBtn.textContent = '–ó–±–µ—Ä–µ–≥—Ç–∏';
        saveBtn.style.marginTop = '8px';
        contentDiv.replaceWith(textarea);
        textarea.after(saveBtn);
        saveBtn.addEventListener('click', () => {
          post.text = textarea.value.trim();
          savePosts();
          renderPosts(container, onlyUser);
        });
      });
    }

    renderComments(post.id, postEl.querySelector(`#comments-${post.id}`));
    container.appendChild(postEl);
  });
}

function renderComments(postId, container) {
  container.innerHTML = '';
  const post = posts.find(p => p.id === postId);
  (post?.comments || []).forEach(c => {
    const div = document.createElement('div');
    div.className = 'comment';
    div.innerHTML = `<strong>${c.user}</strong>: ${c.text}`;
    container.appendChild(div);
  });
}

function getAvatar(uname) {
  if (uname === username) return userData.avatar || '';
  return '';
}

// –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é
function updateProfile() {
  if (!username) return;
  document.getElementById('profileUsernameDisplay').textContent = username;
  document.getElementById('registerDate').textContent = userData.registered || '–Ω–µ–≤—ñ–¥–æ–º–æ';
  document.getElementById('profileBio').textContent = userData.bio || '–ù–µ–º–∞—î –æ–ø–∏—Å—É...';
  const avatarEl = document.getElementById('profileAvatar');
  avatarEl.style.backgroundImage = userData.avatar ? `url('${userData.avatar}')` : '';
  let postCount = 0, likeCount = 0, commentCount = 0;
  posts.forEach(p => {
    if (p.username === username) {
      postCount++;
      likeCount += p.likes || 0;
      commentCount += p.comments?.length || 0;
    }
  });
  document.getElementById('postCount').textContent = postCount;
  document.getElementById('likeCount').textContent = likeCount;
  document.getElementById('commentCount').textContent = commentCount;
  document.getElementById('favoriteCount').textContent = userData.favorites?.length || 0;
  renderPosts(document.getElementById('profilePosts'), true);
}

function savePosts() {
  localStorage.setItem(KEY.POSTS, JSON.stringify(posts));
}

// –ü–æ—á–∞—Ç–æ–∫
if (username) {
  renderPosts();
  updateProfile();
}
</script>
