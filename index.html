<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FANTASYAS - Соцмережа</title>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
:root {
  --bg:#0a0a0a; --text:#f0f0f0; --text-sec:#a0a0a0; --card:#1a1a1a; --border:#333; --shadow:0 4px 20px rgba(0,0,0,0.3);
}
body.light {--bg:#fff; --text:#1a1a1a; --text-sec:#666; --card:#f4f4f4; --border:#ccc; --shadow:0 4px 20px rgba(0,0,0,0.1);}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Manrope',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;transition:0.4s;}
/* Анімації */
@keyframes fadeIn{0%{opacity:0;}100%{opacity:1;}}
@keyframes slideInLeft{0%{opacity:0;transform:translateX(-50px);}100%{opacity:1;transform:translateX(0);}}
.fade-in{animation:fadeIn 0.8s ease-in-out;}
.slide-in{animation:slideInLeft 0.6s ease-out;}
.bounce{animation:0.7s ease bounceIn;}
.pulse{animation:1.5s infinite pulse;}
.rotate{animation:0.9s ease rotateIn;}

/* Верхня панель */
.top-bar{position:fixed;top:0;left:0;right:0;height:60px;display:flex;align-items:center;justify-content:space-between;padding:0 20px;background:rgba(10,10,10,0.95);backdrop-filter:blur(20px);z-index:1000;box-shadow:var(--shadow);transition:0.4s;}
body.light .top-bar{background:rgba(255,255,255,0.95);}
.site-name{font-size:1.8rem;font-weight:800;color:var(--text);}
.burger{cursor:pointer;width:30px;height:22px;display:flex;flex-direction:column;justify-content:space-between;}
.burger span{height:3px;background:var(--text);transition:0.4s;border-radius:2px;}
.burger.active span:nth-child(1){transform:rotate(45deg) translate(6px,6px);}
.burger.active span:nth-child(2){opacity:0;}
.burger.active span:nth-child(3){transform:rotate(-45deg) translate(7px,-7px);}

/* Бокова панель */
.sidebar{position:fixed;top:0;left:-300px;width:300px;height:100%;background:var(--card);padding:80px 25px;transition:0.6s cubic-bezier(0.68,-0.55,0.265,1.55);z-index:900;box-shadow:var(--shadow);}
.sidebar.active{left:0;}
.sidebar a{display:flex;align-items:center;gap:15px;color:var(--text-sec);text-decoration:none;font-size:1.2rem;font-weight:600;margin:15px 0;padding:10px 15px;border-radius:12px;transition:0.3s;}
.sidebar a:hover{background:var(--border);color:var(--text);transform:translateX(10px);box-shadow:var(--shadow);}

/* Контент */
.main-content{margin-top:70px;padding:25px;max-width:900px;margin:0 auto;}
.section{display:none;}
.section.active{display:block;animation:fadeIn 0.8s ease;}
.card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:25px;margin-bottom:25px;box-shadow:var(--shadow);}
.card:hover{transform:translateY(-5px);box-shadow:0 10px 30px rgba(0,0,0,0.2);}
input,textarea{width:100%;padding:15px;margin:10px 0;border:1px solid var(--border);border-radius:15px;background:var(--card);color:var(--text);}
button{padding:12px 25px;border:none;border-radius:15px;background:var(--border);color:var(--text);cursor:pointer;}
button:hover{background:var(--text-sec);}
.feed{display:flex;flex-direction:column;gap:15px;}
.post{background:var(--card);border-radius:20px;padding:15px;box-shadow:var(--shadow);}
.avatar{width:50px;height:50px;border-radius:50%;background:#444;background-size:cover;border:2px solid var(--border);}
@media (max-width:768px){.sidebar{width:100%;left:-100%;}.main-content{padding:15px;}}
</style>
</head>
<body>
<div class="top-bar">
  <div class="burger" id="burger"><span></span><span></span><span></span></div>
  <div class="site-name">FANTASYAS</div>
</div>

<nav class="sidebar" id="sidebar">
  <a data-section="home"><i class="fas fa-home"></i> Головна</a>
  <a data-section="profile"><i class="fas fa-user"></i> Профіль</a>
  <a data-section="chat"><i class="fas fa-comments"></i> Чати</a>
  <a data-section="settings"><i class="fas fa-cog"></i> Налаштування</a>
</nav>

<main class="main-content">
<section id="home" class="section active">
  <div class="card" id="auth-card">
    <h2>Вхід</h2>
    <input id="login-nick" placeholder="Псевдонім">
    <input id="login-pass" type="password" placeholder="Пароль">
    <button id="login-btn">Увійти</button>
    <p>Нема акаунта? <span id="to-reg">Зареєструватися</span></p>
  </div>
  <div class="card" id="reg-card" style="display:none;">
    <h2>Реєстрація</h2>
    <input id="reg-nick" placeholder="Псевдонім">
    <input id="reg-pass" type="password" placeholder="Пароль">
    <button id="reg-btn">Зареєструватися</button>
    <p>Є акаунт? <span id="to-login">Увійти</span></p>
  </div>
  <div class="card" id="post-form" style="display:none;">
    <textarea id="post-text" placeholder="Напиши пост..."></textarea>
    <button id="submit-post">Опублікувати</button>
  </div>
  <div class="feed" id="feed"></div>
</section>

<section id="profile" class="section">
  <div class="card">
    <div class="avatar" id="profile-avatar"></div>
    <h2 id="profile-nick">@Псевдонім</h2>
    <p id="profile-bio">Тут коротко про себе</p>
  </div>
</section>

<section id="chat" class="section">
  <div class="card" id="chat-users"></div>
  <div class="card" id="chat-window" style="display:none;">
    <h3 id="chat-with"></h3>
    <div id="chat-messages"></div>
    <input id="chat-input" placeholder="Написати повідомлення">
    <button id="send-message">Надіслати</button>
  </div>
</section>

<section id="settings" class="section">
  <div class="card">
    <button id="toggle-theme">Світла / Темна тема</button>
  </div>
</section>
</main>

<script>
let db,currentUser=null;
const request=indexedDB.open('FantasyasDB',1);
request.onupgradeneeded=e=>{db=e.target.result;db.createObjectStore('users',{keyPath:'nick'});db.createObjectStore('posts',{autoIncrement:true});db.createObjectStore('messages',{autoIncrement:true});}
request.onsuccess=e=>{db=e.target.result;initApp();}

function initApp(){
  const burger=document.getElementById('burger');
  const sidebar=document.getElementById('sidebar');
  burger.onclick=()=>{burger.classList.toggle('active');sidebar.classList.toggle('active');}

  document.querySelectorAll('.sidebar a').forEach(a=>{
    a.onclick=()=>{document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
      document.getElementById(a.dataset.section).classList.add('active');
      sidebar.classList.remove('active');burger.classList.remove('active');
      if(a.dataset.section==='profile') loadProfile();
      if(a.dataset.section==='chat') loadChatUsers();
    }
  });

  document.getElementById('to-reg').onclick=()=>{document.getElementById('auth-card').style.display='none';document.getElementById('reg-card').style.display='block';};
  document.getElementById('to-login').onclick=()=>{document.getElementById('reg-card').style.display='none';document.getElementById('auth-card').style.display='block';};

  document.getElementById('reg-btn').onclick=()=>{
    const nick=document.getElementById('reg-nick').value.trim();
    const pass=document.getElementById('reg-pass').value.trim();
    if(!nick||!pass)return alert('Заповніть поля');
    const tx=db.transaction('users','readwrite').objectStore('users');
    tx.get(nick).onsuccess=e=>{if(e.target.result)return alert('Нік зайнятий');tx.add({nick,pass});alert('Успішно!');document.getElementById('to-login').click();}
  }

  document.getElementById('login-btn').onclick=()=>{
    const nick=document.getElementById('login-nick').value.trim();
    const pass=document.getElementById('login-pass').value.trim();
    const tx=db.transaction('users').objectStore('users');
    tx.get(nick).onsuccess=e=>{
      const user=e.target.result;
      if(!user||user.pass!==pass)return alert('Невірні дані');
      currentUser=nick;document.getElementById('auth-card').style.display='none';
      document.getElementById('post-form').style.display='block';loadPosts();
    }
  }

  document.getElementById('submit-post').onclick=()=>{
    const text=document.getElementById('post-text').value.trim();
    if(!text)return alert('Напишіть пост');
    const post={author:currentUser,text,created:Date.now()};
    const tx=db.transaction('posts','readwrite').objectStore('posts');tx.add(post);
    tx.transaction.oncomplete=()=>{document.getElementById('post-text').value='';loadPosts();}
  }

  function loadPosts(){
    const feed=document.getElementById('feed');feed.innerHTML='';
    const tx=db.transaction('posts').objectStore('posts');
    tx.openCursor(null,'prev').onsuccess=e=>{
      let cursor=e.target.result;if(cursor){const p=cursor.value;
        const div=document.createElement('div');div.className='post';div.innerHTML=`<strong>@${p.author}</strong>: ${p.text}`;
        feed.appendChild(div);cursor.continue();}
    }
  }

  function loadProfile(){
    if(!currentUser)return alert('Увійдіть');
    document.getElementById('profile-nick').textContent='@'+currentUser;
  }

  document.getElementById('toggle-theme').onclick=()=>{document.body.classList.toggle('light');}

  // Чати
  function loadChatUsers(){
    const container=document.getElementById('chat-users');container.innerHTML='';
    const tx=db.transaction('users').objectStore('users');
    tx.openCursor().onsuccess=e=>{
      const c=e.target.result;if(c){if(c.value.nick!==currentUser){
        const div=document.createElement('div');div.className='post';div.innerHTML=`@${c.value.nick}`;div.onclick=()=>openChat(c.value.nick);
        container.appendChild(div);}
        c.continue();
      }
    }
  }

  function openChat(nick){
    document.getElementById('chat-window').style.display='block';
    document.getElementById('chat-with').textContent='Чат з @'+nick;
    document.getElementById('send-message').onclick=()=>{
      const text=document.getElementById('chat-input').value.trim();
      if(!text)return;
      const msg={from:currentUser,to:nick,text,created:Date.now()};
      const tx=db.transaction('messages','readwrite').objectStore('messages');tx.add(msg);
      tx.transaction.oncomplete=()=>{document.getElementById('chat-input').value='';loadMessages(nick);}
    }
    loadMessages(nick);
  }

  function loadMessages(nick){
    const box=document.getElementById('chat-messages');box.innerHTML='';
    const tx=db.transaction('messages').objectStore('messages');
    tx.openCursor().onsuccess=e=>{
      const c=e.target.result;if(c){const m=c.value;
        if((m.from===currentUser&&m.to===nick)||(m.from===nick&&m.to===currentUser)){
          const div=document.createElement('div');div.className='post';div.innerHTML=`<strong>@${m.from}</strong>: ${m.text}`;
          box.appendChild(div);}
        c.continue();
      }
    }
  }
}
</script>
</body>
</html>
