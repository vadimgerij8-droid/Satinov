<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FANTASYAS - Соцмережа</title>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    :root {
      --bg: #0a0a0a;
      --text: #f5f5f5;
      --text-sec: #aaa;
      --card: #121212;
      --border: #222;
      --shadow: 0 4px 20px rgba(0,0,0,0.5);
    }

    body { margin:0; font-family: 'Manrope', sans-serif; background: var(--bg); color: var(--text); transition: all 0.4s ease; min-height: 100vh; }
    * { box-sizing: border-box; }

    /* Анімації */
    @keyframes fadeIn { 0% {opacity:0} 100% {opacity:1} }
    @keyframes slideInLeft { 0% {opacity:0; transform: translateX(-30px)} 100% {opacity:1; transform: translateX(0)} }
    .fade { animation: fadeIn 0.6s ease; }
    .slide { animation: slideInLeft 0.5s ease; }

    /* Топ-бар */
    .top-bar {
      position: fixed; top:0; left:0; right:0; height:60px;
      display:flex; align-items:center; justify-content: space-between;
      padding:0 20px; background: #0f0f0f; box-shadow: var(--shadow); z-index:1000;
    }
    .site-name { font-weight:800; font-size:1.8rem; }
    .burger { width:30px; height:22px; display:flex; flex-direction:column; justify-content:space-between; cursor:pointer; }
    .burger span { height:3px; background: var(--text); border-radius:2px; transition:0.3s; }
    .burger.active span:nth-child(1){transform:rotate(45deg) translate(5px,5px);}
    .burger.active span:nth-child(2){opacity:0;}
    .burger.active span:nth-child(3){transform:rotate(-45deg) translate(5px,-5px);}

    /* Бокове меню */
    .sidebar {
      position:fixed; top:0; left:-260px; width:260px; height:100%;
      background: #111; padding:80px 20px; transition: left 0.4s ease; z-index:900; box-shadow: var(--shadow);
    }
    .sidebar.active { left:0; }
    .sidebar a { display:flex; align-items:center; gap:12px; color: var(--text-sec); text-decoration:none; margin:12px 0; padding:10px 12px; border-radius:10px; transition:0.3s; }
    .sidebar a:hover { background: var(--card); color: var(--text); transform: translateX(5px); }

    /* Основний контент */
    .main-content { margin-top:70px; padding:20px; max-width:900px; margin-left:auto; margin-right:auto; }
    .section { display:none; }
    .section.active { display:block; animation:fadeIn 0.6s ease; }

    /* Карточки постів */
    .card { background: var(--card); border:1px solid var(--border); border-radius:15px; padding:20px; margin-bottom:20px; box-shadow: var(--shadow); transition:0.3s; }
    .card:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(255,255,255,0.05); }

    input, textarea { width:100%; padding:12px; margin:8px 0; border-radius:10px; border:1px solid var(--border); background: #1a1a1a; color: var(--text); font-size:1rem; }
    input:focus, textarea:focus { outline:none; border-color: #555; }

    button { padding:10px 20px; border:none; border-radius:10px; background:#222; color:var(--text); cursor:pointer; font-weight:600; transition:0.3s; }
    button:hover { background:#333; transform: translateY(-2px); }

    .feed { display:flex; flex-direction:column; gap:20px; }

    .post-header { display:flex; align-items:center; gap:10px; margin-bottom:10px; }
    .avatar { width:40px; height:40px; border-radius:50%; background:#333; border:1px solid #555; }

    .chat-window { height:400px; display:flex; flex-direction:column; border-radius:10px; overflow:hidden; background:#1a1a1a; box-shadow: var(--shadow); }
    .chat-messages { flex:1; overflow-y:auto; padding:10px; }
    .message { padding:10px 14px; border-radius:10px; margin:6px 0; max-width:70%; }
    .message.sent { background:#333; align-self:flex-end; }
    .message.received { background:#222; align-self:flex-start; }

    /* Модальні вікна */
    .modal { position:fixed; inset:0; background:rgba(0,0,0,0.8); display:none; align-items:center; justify-content:center; z-index:2000; }
    .modal.active { display:flex; }
    .modal-content { background:var(--card); border-radius:15px; padding:25px; width:90%; max-width:500px; }

    @media(max-width:768px){ .sidebar{width:100%; left:-100%;} .main-content{padding:15px;} }
  </style>
</head>
<body>
<div class="top-bar">
  <div class="burger" id="burger"><span></span><span></span><span></span></div>
  <div class="site-name">FANTASYAS</div>
</div>

<nav class="sidebar" id="sidebar">
  <a data-section="home"><i class="fas fa-home"></i> Головна</a>
  <a data-section="search"><i class="fas fa-search"></i> Пошук</a>
  <a data-section="profile"><i class="fas fa-user"></i> Профіль</a>
  <a data-section="chat"><i class="fas fa-comments"></i> Чати</a>
  <a data-section="settings"><i class="fas fa-cog"></i> Налаштування</a>
</nav>

<main class="main-content">
  <section id="home" class="section active">
    <div class="card" id="auth-card">
      <div id="login-form">
        <h2 class="fade">Вхід</h2>
        <input id="login-nick" placeholder="Псевдонім" class="slide">
        <input id="login-pass" type="password" placeholder="Пароль" class="slide">
        <button id="login-btn">Увійти</button>
        <p class="fade">Немає акаунта? <span id="to-reg">Зареєструватись</span></p>
      </div>
      <div id="reg-form" style="display:none;">
        <h2 class="fade">Реєстрація</h2>
        <input id="reg-nick" placeholder="Псевдонім" class="slide">
        <input id="reg-pass" type="password" placeholder="Пароль" class="slide">
        <button id="reg-btn">Зареєструватись</button>
        <p class="fade">Є акаунт? <span id="to-login">Увійти</span></p>
      </div>
    </div>

    <div class="card" id="post-form" style="display:none;">
      <textarea id="post-text" placeholder="Створи пост..." class="slide"></textarea>
      <button id="submit-post">Опублікувати</button>
    </div>

    <div class="feed" id="feed"></div>
  </section>
</main>

<div class="modal" id="modal">
  <div class="modal-content">
    <span id="close-modal" style="cursor:pointer;">&times;</span>
    <div id="modal-body"></div>
  </div>
</div>

<script>
let db;
const request = indexedDB.open('FantasyasDB',1);
request.onupgradeneeded = e => {
  db = e.target.result;
  db.createObjectStore('users',{keyPath:'nick'});
  db.createObjectStore('posts',{autoIncrement:true});
};
request.onsuccess = e => { db = e.target.result; initApp(); };
let currentUser = localStorage.getItem('user');

function initApp(){
  const burger = document.getElementById('burger');
  const sidebar = document.getElementById('sidebar');
  burger.addEventListener('click',()=>{burger.classList.toggle('active'); sidebar.classList.toggle('active');});

  document.querySelectorAll('.sidebar a').forEach(a=>{
    a.addEventListener('click',()=>{
      document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
      document.getElementById(a.dataset.section).classList.add('active');
      sidebar.classList.remove('active'); burger.classList.remove('active');
    });
  });

  document.getElementById('to-reg').addEventListener('click',()=>{
    document.getElementById('login-form').style.display='none';
    document.getElementById('reg-form').style.display='block';
  });
  document.getElementById('to-login').addEventListener('click',()=>{
    document.getElementById('reg-form').style.display='none';
    document.getElementById('login-form').style.display='block';
  });

  document.getElementById('reg-btn').addEventListener('click',()=>{
    const nick = document.getElementById('reg-nick').value.trim();
    const pass = document.getElementById('reg-pass').value.trim();
    if(!nick||!pass) return alert('Заповніть поля');
    const tx = db.transaction('users','readwrite');
    const store = tx.objectStore('users');
    store.get(nick).onsuccess=e=>{
      if(e.target.result) return alert('Нік зайнятий');
      store.add({nick,pass,posts:[]});
      alert('Реєстрація успішна!'); document.getElementById('to-login').click();
    };
  });

  document.getElementById('login-btn').addEventListener('click',()=>{
    const nick = document.getElementById('login-nick').value.trim();
    const pass = document.getElementById('login-pass').value.trim();
    const tx = db.transaction('users'); const store = tx.objectStore('users');
    store.get(nick).onsuccess=e=>{
      const user = e.target.result;
      if(!user||user.pass!==pass) return alert('Невірні дані');
      currentUser = nick; localStorage.setItem('user',nick);
      document.getElementById('auth-card').style.display='none';
      document.getElementById('post-form').style.display='block';
      loadPosts();
    };
  });

  document.getElementById('submit-post').addEventListener('click',()=>{
    const text = document.getElementById('post-text').value.trim();
    if(!text) return alert('Напишіть пост');
    const post = {author:currentUser,text,created:Date.now(),comments:[],likes:0};
    const tx = db.transaction('posts','readwrite'); tx.objectStore('posts').add(post);
    tx.oncomplete=()=>{document.getElementById('post-text').value=''; loadPosts();};
  });

  function loadPosts(){
    const feed = document.getElementById('feed'); feed.innerHTML='';
    const tx = db.transaction('posts'); tx.objectStore('posts').openCursor(null,'prev').onsuccess=e=>{
      const cursor=e.target.result; if(cursor){const post=cursor.value;
        const div=document.createElement('div'); div.className='post card fade';
        div.innerHTML=`<div class="post-header"><div class="avatar"></div><span>@${post.author}</span></div><p>${post.text}</p>`;
        feed.appendChild(div); cursor.continue();
      }
    };
  }

  if(currentUser){document.getElementById('auth-card').style.display='none'; document.getElementById('post-form').style.display='block'; loadPosts();}

  document.getElementById('close-modal').addEventListener('click',()=>{document.getElementById('modal').classList.remove('active');});
}
</script>
</body>
</html>
