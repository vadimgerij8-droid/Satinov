<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FANTASYAS</title>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;600;700;800&display=swap" rel="stylesheet">
<style>
/* ❗ CSS НЕ ЗМІНЮВАВСЯ – ТВОЙ ОРИГІНАЛ */
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Manrope',sans-serif;background:#000;color:#fff;min-height:100vh;overflow-x:hidden}
body.light{background:#f8f9fa;color:#111}
body.large-font{font-size:1.12rem}
/* … весь твій CSS без змін … */
</style>
</head>
<body>

<div class="top-bar">
  <div class="burger" id="burger"><span></span><span></span><span></span></div>
  <div class="site-name">FANTASYAS</div>
</div>

<nav class="sidebar" id="sidebar">
  <a data-section="home">Головна</a>
  <a data-section="favorites">Обране</a>
  <a data-section="drafts">Чернетки</a>
  <a data-section="profile">Профіль</a>
  <a data-section="settings">Налаштування</a>
</nav>

<main class="main-content">

<div id="home" class="section active">
  <div class="login-box" id="loginBox">
    <input id="usernameInput" placeholder="Введіть ім'я">
    <button id="saveUsername">Почати</button>
  </div>

  <div class="new-post" id="newPostBox" style="display:none;">
    <textarea id="postText" placeholder="Що у тебе на думці?..."></textarea>
    <div style="display:flex;gap:10px;">
      <button id="addPost">Опублікувати</button>
      <button id="saveDraft">Чернетка</button>
    </div>
  </div>

  <div class="feed" id="feed"></div>
</div>

<div id="favorites" class="section">
  <h2>Обране</h2>
  <div class="feed" id="favoritesFeed"></div>
</div>

<div id="drafts" class="section">
  <h2>Чернетки</h2>
  <div class="feed" id="draftFeed"></div>
</div>

<div id="profile" class="section">
  <h2 id="profileUsernameDisplay"></h2>
  <div id="profilePosts" class="feed"></div>
</div>

<div id="settings" class="section">
  <h2>Налаштування</h2>
  <input type="file" id="avatarFile" accept="image/*">
  <textarea id="changeBio" placeholder="Про себе"></textarea>
  <button id="saveSettings">Зберегти</button>
</div>

</main>

<script>
const KEY={
 USERNAME:'fantasyasUsername',
 USER:'fantasyasUserData',
 POSTS:'fantasyas_posts',
 AVATARS:'fantasyas_avatars',
 DRAFTS:'fantasyas_drafts'
};

let username=localStorage.getItem(KEY.USERNAME);
let posts=JSON.parse(localStorage.getItem(KEY.POSTS))||[];
let drafts=JSON.parse(localStorage.getItem(KEY.DRAFTS))||[];
let avatars=JSON.parse(localStorage.getItem(KEY.AVATARS))||{};
let userData=JSON.parse(localStorage.getItem(KEY.USER))||{bio:'',favorites:[]};

const sections=document.querySelectorAll('.section');
document.querySelectorAll('[data-section]').forEach(a=>{
 a.onclick=()=>{sections.forEach(s=>s.classList.remove('active'));
 document.getElementById(a.dataset.section).classList.add('active');
 sidebar.classList.remove('active');burger.classList.remove('active');}
});

burger.onclick=()=>{burger.classList.toggle('active');sidebar.classList.toggle('active');};

function saveAll(){
 localStorage.setItem(KEY.POSTS,JSON.stringify(posts));
 localStorage.setItem(KEY.DRAFTS,JSON.stringify(drafts));
 localStorage.setItem(KEY.AVATARS,JSON.stringify(avatars));
 localStorage.setItem(KEY.USER,JSON.stringify(userData));
}

function avatarOf(name){return avatars[name]||'';}

saveUsername.onclick=()=>{
 username=usernameInput.value.trim();
 if(!username)return;
 localStorage.setItem(KEY.USERNAME,username);
 loginBox.style.display='none';
 newPostBox.style.display='flex';
 renderAll();
};

addPost.onclick=()=>{
 if(!postText.value)return;
 posts.unshift({id:Date.now(),user:username,text:postText.value});
 postText.value='';
 saveAll();renderAll();
};

saveDraft.onclick=()=>{
 drafts.unshift({id:Date.now(),user:username,text:postText.value});
 postText.value='';
 saveAll();renderAll();
};

avatarFile.onchange=e=>{
 const f=e.target.files[0];
 if(!f)return;
 const r=new FileReader();
 r.onload=()=>{avatars[username]=r.result;saveAll();renderAll();}
 r.readAsDataURL(f);
};

function renderFeed(list,container,allowDelete){
 container.innerHTML='';
 list.forEach(p=>{
  const d=document.createElement('div');
  d.className='post';
  d.innerHTML=`
   <div class="post-header">
    <div class="avatar" style="background-image:url('${avatarOf(p.user)}')"></div>
    <div class="username">${p.user}</div>
   </div>
   <div class="post-content">${p.text}</div>
   ${allowDelete&&p.user===username?'<button class="danger-btn">Видалити</button>':''}
  `;
  if(allowDelete&&p.user===username){
   d.querySelector('button').onclick=()=>{
    posts=posts.filter(x=>x.id!==p.id);
    drafts=drafts.filter(x=>x.id!==p.id);
    userData.favorites=userData.favorites.filter(id=>id!==p.id);
    saveAll();renderAll();
   };
  }
  container.appendChild(d);
 });
}

function renderAll(){
 renderFeed(posts,feed,true);
 renderFeed(posts.filter(p=>userData.favorites.includes(p.id)),favoritesFeed,false);
 renderFeed(drafts.filter(d=>d.user===username),draftFeed,true);
 renderFeed(posts.filter(p=>p.user===username),profilePosts,true);
 profileUsernameDisplay.textContent=username;
}

if(username){
 loginBox.style.display='none';
 newPostBox.style.display='flex';
 renderAll();
}
</script>

</body>
</html>
